# ุณููุงุฑูู ุงุฎุชุจุงุฑ ูุงูู - ูุธุงู ุงููุณุชุดููุงุช ุงููุชุนุฏุฏุฉ

## ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงูููู ูุดุฑุญ ุณููุงุฑูู ุงุฎุชุจุงุฑ ูุงูู ูููุธุงู ูู ุงูุจุฏุงูุฉ ููููุงูุฉ.

---

## ุงูุณููุงุฑูู ุงููุงูู

### ุงููุฑุญูุฉ 1: ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ

#### 1.1 ุฅูุดุงุก ูุณุชุฎุฏู Super Admin
**Endpoint:** `POST /api/auth/register`

**Request:**
```json
{
  "name": "ูุฏูุฑ ุงููุธุงู",
  "email": "admin@hospital.com",
  "phone": "0501234567",
  "password": "password123",
  "user_type": "super_admin"
}
```

**Expected Response:**
```json
{
  "status": 201,
  "message": "ุชู ุงูุชุณุฌูู ุจูุฌุงุญ",
  "data": {
    "user": {
      "id": 1,
      "name": "ูุฏูุฑ ุงููุธุงู",
      "email": "admin@hospital.com",
      "user_type": "super_admin"
    },
    "token": "..."
  }
}
```

#### 1.2 ุชุณุฌูู ุงูุฏุฎูู ูู Super Admin
**Endpoint:** `POST /api/auth/login`

**Request:**
```json
{
  "email": "admin@hospital.com",
  "password": "password123"
}
```

**Response:** ุงุญูุธ ุงูู token ููุงุณุชุฎุฏุงู ูุงุญูุงู

---

### ุงููุฑุญูุฉ 2: ุฅุนุฏุงุฏ ุงููุณุชุดููุงุช

#### 2.1 ุฅูุดุงุก ูุณุชุฎุฏููู ูู ููุน Hospital
**Endpoint:** `POST /api/auth/register`

**Request 1 - ูุณุชุดูู ุงูููุฑ:**
```json
{
  "name": "ูุณุชุดูู ุงูููุฑ",
  "email": "hospital1@hospital.com",
  "phone": "0501111111",
  "password": "password123",
  "user_type": "hospital"
}
```

**Request 2 - ูุณุชุดูู ุงูุฃูู:**
```json
{
  "name": "ูุณุชุดูู ุงูุฃูู",
  "email": "hospital2@hospital.com",
  "phone": "0502222222",
  "password": "password123",
  "user_type": "hospital"
}
```

#### 2.2 ุชุณุฌูู ุงูุฏุฎูู ุฅูู Filament Dashboard
1. ุงุฐูุจ ุฅูู: `http://127.0.0.1:8000/admin`
2. ุณุฌู ุงูุฏุฎูู ุจู Super Admin
3. ุงุฐูุจ ุฅูู "ุงููุณุชุดููุงุช" โ "ุฅูุดุงุก ุฌุฏูุฏ"

#### 2.3 ุฅูุดุงุก ูุณุชุดูู ุงูููุฑ
**ูู Filament Dashboard:**
- **ุงููุณุชุฎุฏู:** ุงุฎุชุฑ ุงููุณุชุฎุฏู ุงูุฐู ุฃูุดุฃุชู ููุณุชุดูู ุงูููุฑ
- **ุงุณู ุงููุณุชุดูู:** ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู
- **ุงูุนููุงู:** ุดุงุฑุน ุงูููู ููุฏุ ุงูุฑูุงุถ
- **ุฎุท ุงูุนุฑุถ (Latitude):** 24.7136
- **ุฎุท ุงูุทูู (Longitude):** 46.6753
- **ุงููููุน:** ุงูุฑูุงุถุ ุงูุณุนูุฏูุฉ

#### 2.4 ุฅูุดุงุก ูุณุชุดูู ุงูุฃูู
**ูู Filament Dashboard:**
- **ุงููุณุชุฎุฏู:** ุงุฎุชุฑ ุงููุณุชุฎุฏู ุงูุฐู ุฃูุดุฃุชู ููุณุชุดูู ุงูุฃูู
- **ุงุณู ุงููุณุชุดูู:** ูุณุชุดูู ุงูุฃูู
- **ุงูุนููุงู:** ุดุงุฑุน ุงูุนููุงุ ุงูุฑูุงุถ
- **ุฎุท ุงูุนุฑุถ (Latitude):** 24.7236
- **ุฎุท ุงูุทูู (Longitude):** 46.6853
- **ุงููููุน:** ุงูุฑูุงุถุ ุงูุณุนูุฏูุฉ

---

### ุงููุฑุญูุฉ 3: ุฅูุดุงุก ูุณุชุฎุฏููู (ูุฑูุถ ููุชุจุฑุน)

#### 3.1 ุฅูุดุงุก ูุฑูุถ
**Endpoint:** `POST /api/auth/register`

**Request:**
```json
{
  "name": "ุฃุญูุฏ ูุญูุฏ",
  "email": "patient@test.com",
  "phone": "0503333333",
  "password": "password123",
  "user_type": "patient",
  "blood": "O+",
  "gender": "male"
}
```

**Response:** ุงุญูุธ ุงูู token ู user_id

#### 3.2 ุฅูุดุงุก ูุชุจุฑุน
**Endpoint:** `POST /api/auth/register`

**Request:**
```json
{
  "name": "ูุญูุฏ ุนูู",
  "email": "donor@test.com",
  "phone": "0504444444",
  "password": "password123",
  "user_type": "donner",
  "blood": "O+",
  "gender": "male"
}
```

**Response:** ุงุญูุธ ุงูู token ู user_id

---

### ุงููุฑุญูุฉ 4: ุชุญุฏูุซ ููุงูุน ุงููุณุชุฎุฏููู

#### 4.1 ุชุญุฏูุซ ูููุน ุงููุฑูุถ
**Endpoint:** `POST /api/location`
**Headers:** `Authorization: Bearer {patient_token}`

**Request:**
```json
{
  "lat": 24.7136,
  "lng": 46.6753
}
```

#### 4.2 ุชุญุฏูุซ ูููุน ุงููุชุจุฑุน
**Endpoint:** `POST /api/location`
**Headers:** `Authorization: Bearer {donor_token}`

**Request:**
```json
{
  "lat": 24.7236,
  "lng": 46.6853
}
```

---

### ุงููุฑุญูุฉ 5: ุฅูุดุงุก ุทูุจ SOS ูู ุงููุฑูุถ

#### 5.1 ุฅูุดุงุก ุทูุจ SOS
**Endpoint:** `POST /api/sos`
**Headers:** `Authorization: Bearer {patient_token}`

**Request:**
```json
{
  "type": "blood",
  "blood": "O+",
  "latitude": 24.7136,
  "longitude": 46.6753,
  "description": "ุฃุญุชุงุฌ ุชุจุฑุน ุฏู ุนุงุฌู"
}
```

**Expected Response:**
```json
{
  "status": 201,
  "message": "ุชู ุฅูุดุงุก ุทูุจ SOS ุจูุฌุงุญ ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ูููุชุจุฑุนูู ุงููุฑูุจูู",
  "data": {
    "sos_id": 1,
    "donors_count": 1,
    "notifications": {
      "success": 1,
      "failure": 0
    }
  }
}
```

**ููุงุญุธุฉ:** ุณูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุชุจุฑุน ุงููุฑูุจ

---

### ุงููุฑุญูุฉ 6: ุงููุชุจุฑุน ูุฑู ุงูุญุงูุงุช ุงููุชุงุญุฉ

#### 6.1 ุนุฑุถ ุงูุญุงูุงุช ุงููุชุงุญุฉ ูููุชุจุฑุน
**Endpoint:** `GET /api/available-sos-cases`
**Headers:** `Authorization: Bearer {donor_token}`

**Expected Response:**
```json
{
  "status": 200,
  "message": "ุชู ุฌูุจ ุงูุญุงูุงุช ุงููุชุงุญุฉ ุจูุฌุงุญ",
  "data": {
    "items": {
      "available_cases": [
        {
          "id": 1,
          "patient": {
            "id": 2,
            "name": "ุฃุญูุฏ ูุญูุฏ",
            "phone": "0503333333"
          },
          "type": "blood",
          "blood_type": "O+",
          "distance_km": 0.5,
          "is_new": true
        }
      ],
      "new_cases": [...],
      "summary": {
        "total": 1,
        "new_count": 1
      }
    }
  }
}
```

---

### ุงููุฑุญูุฉ 7: ุฅูุฌุงุฏ ุฃูุฑุจ ูุณุชุดูู

#### 7.1 ุงููุฑูุถ ูุฌุฏ ุฃูุฑุจ ูุณุชุดูู
**Endpoint:** `GET /api/hospital-requests/find-nearest`
**Headers:** `Authorization: Bearer {patient_token}`

**Expected Response:**
```json
{
  "status": 200,
  "message": "ุชู ุงูุนุซูุฑ ุนูู ุฃูุฑุจ ูุณุชุดูู",
  "data": {
    "items": {
      "hospital": {
        "id": 1,
        "name": "ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู",
        "address": "ุดุงุฑุน ุงูููู ููุฏุ ุงูุฑูุงุถ",
        "latitude": 24.7136,
        "longitude": 46.6753
      }
    }
  }
}
```

#### 7.2 ุงููุชุจุฑุน ูุฌุฏ ุฃูุฑุจ ูุณุชุดูู
**Endpoint:** `GET /api/hospital-requests/find-nearest`
**Headers:** `Authorization: Bearer {donor_token}`

---

### ุงููุฑุญูุฉ 8: ุฅุฑุณุงู ุทูุจุงุช ูููุณุชุดูู

#### 8.1 ุงููุฑูุถ ูุฑุณู ุทูุจ ูููุณุชุดูู
**Endpoint:** `POST /api/hospital-requests/`
**Headers:** `Authorization: Bearer {patient_token}`

**Request:**
```json
{
  "hospital_id": 1,
  "sos_request_id": 1,
  "user_notes": "ุฃุญุชุงุฌ ุนูููุฉ ููู ุฏู ุนุงุฌูุฉ"
}
```

**Expected Response:**
```json
{
  "status": 201,
  "message": "ุชู ุฅุฑุณุงู ุงูุทูุจ ูููุณุชุดูู ุจูุฌุงุญ",
  "data": {
    "items": {
      "request_id": 1,
      "hospital_id": 1,
      "hospital_name": "ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู",
      "status": "pending"
    }
  }
}
```

**ููุงุญุธุฉ:** ุณูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุณุชุดูู

#### 8.2 ุงููุชุจุฑุน ูุฑุณู ุทูุจ ูููุณุชุดูู
**Endpoint:** `POST /api/hospital-requests/`
**Headers:** `Authorization: Bearer {donor_token}`

**Request:**
```json
{
  "hospital_id": 1,
  "sos_request_id": 1,
  "user_notes": "ุฃูุง ุฌุงูุฒ ููุชุจุฑุน"
}
```

**Expected Response:**
```json
{
  "status": 201,
  "message": "ุชู ุฅุฑุณุงู ุงูุทูุจ ูููุณุชุดูู ุจูุฌุงุญ",
  "data": {
    "items": {
      "request_id": 2,
      "hospital_id": 1,
      "hospital_name": "ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู",
      "status": "pending"
    }
  }
}
```

---

### ุงููุฑุญูุฉ 9: ุงููุณุชุดูู ูุนุฑุถ ุงูุทูุจุงุช

#### 9.1 ุชุณุฌูู ุงูุฏุฎูู ููุณุชุดูู ูู Filament
1. ุงุฐูุจ ุฅูู: `http://127.0.0.1:8000/admin`
2. ุณุฌู ุงูุฏุฎูู ุจุญุณุงุจ ุงููุณุชุดูู (hospital1@hospital.com)
3. ุงุฐูุจ ุฅูู "ุทูุจุงุช ุงููุณุชุดููุงุช"

**Expected:** ูุฌุจ ุฃู ุชุฑู ุทูุจูู:
- ุทูุจ ูู ุงููุฑูุถ (ุฃุญูุฏ ูุญูุฏ)
- ุทูุจ ูู ุงููุชุจุฑุน (ูุญูุฏ ุนูู)

---

### ุงููุฑุญูุฉ 10: ุงููุณุชุดูู ููุงูู ุนูู ุงูุทูุจุงุช

#### 10.1 ุงูููุงููุฉ ุนูู ุทูุจ ุงููุฑูุถ
**ูู Filament Dashboard:**
1. ุงุฐูุจ ุฅูู "ุทูุจุงุช ุงููุณุชุดููุงุช"
2. ุงุถุบุท ุนูู "ููุงููุฉ" ุจุฌุงูุจ ุทูุจ ุงููุฑูุถ
3. ุฃุถู ููุงุญุธุงุช (ุงุฎุชูุงุฑู): "ุชู ุงูุชุฃูุฏ ูู ุงูุจูุงูุงุชุ ุฌุงูุฒ ููุนูููุฉ"
4. ุงุถุบุท "ููุงูู"

**Expected:**
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ุฅูู "ููุงูู ุนููู"
- ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุฑูุถ

#### 10.2 ุงูููุงููุฉ ุนูู ุทูุจ ุงููุชุจุฑุน
**ูู Filament Dashboard:**
1. ุงุถุบุท ุนูู "ููุงููุฉ" ุจุฌุงูุจ ุทูุจ ุงููุชุจุฑุน
2. ุฃุถู ููุงุญุธุงุช: "ุชู ุงูุชุฃูุฏ ูู ูุตููุฉ ุงูุฏูุ ุฌุงูุฒ ููุชุจุฑุน"
3. ุงุถุบุท "ููุงูู"

**Expected:**
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ุฅูู "ููุงูู ุนููู"
- ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุชุจุฑุน

---

### ุงููุฑุญูุฉ 11: ุงููุฑูุถ ูุงููุชุจุฑุน ูุชุญูููู ูู ุงูุญุงูุงุช

#### 11.1 ุงููุฑูุถ ูุนุฑุถ ุญุงูุงุชู
**Endpoint:** `GET /api/hospital-requests/available-cases`
**Headers:** `Authorization: Bearer {patient_token}`

**Expected Response:**
```json
{
  "status": 200,
  "message": "ุชู ุฌูุจ ุงูุญุงูุงุช ุงููุชุงุญุฉ ุจูุฌุงุญ",
  "data": {
    "items": {
      "all_requests": [
        {
          "id": 1,
          "hospital": {
            "id": 1,
            "name": "ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู",
            "address": "ุดุงุฑุน ุงูููู ููุฏุ ุงูุฑูุงุถ"
          },
          "status": "approved",
          "status_label": "ููุงูู ุนููู",
          "hospital_notes": "ุชู ุงูุชุฃูุฏ ูู ุงูุจูุงูุงุชุ ุฌุงูุฒ ููุนูููุฉ",
          "is_new": true
        }
      ],
      "approved": [...],
      "new_cases": [...]
    }
  }
}
```

#### 11.2 ุงููุชุจุฑุน ูุนุฑุถ ุญุงูุงุชู
**Endpoint:** `GET /api/hospital-requests/available-cases`
**Headers:** `Authorization: Bearer {donor_token}`

---

### ุงููุฑุญูุฉ 12: ุงุฎุชุจุงุฑ ุงูุณููุงุฑูู ุงูุจุฏูู - ุฅุฑุณุงู ุทูุจูู ูุนุงู

#### 12.1 ุฅุฑุณุงู ุทูุจูู ูุนุงู (ูู ุงููุฑูุถ)
**Endpoint:** `POST /api/hospital-requests/both`
**Headers:** `Authorization: Bearer {patient_token}`

**Request:**
```json
{
  "hospital_id": 1,
  "sos_request_id": 1,
  "user_notes": "ุทูุจ ูุดุชุฑู ูู ุงููุฑูุถ ูุงููุชุจุฑุน"
}
```

**Expected Response:**
```json
{
  "status": 201,
  "message": "ุชู ุฅุฑุณุงู ุงูุทูุจุงุช ูููุณุชุดูู ุจูุฌุงุญ",
  "data": {
    "items": {
      "requests": [
        {
          "id": 3,
          "user_id": 2,
          "request_type": "patient",
          "status": "pending"
        },
        {
          "id": 4,
          "user_id": 3,
          "request_type": "donner",
          "status": "pending"
        }
      ],
      "hospital": {
        "id": 1,
        "name": "ูุณุชุดูู ุงูููุฑ ุงูุชุฎุตุตู"
      }
    }
  }
}
```

---

## ุณููุงุฑูู ุงูุฑูุถ (ุงุฎุชูุงุฑู)

### ุงููุณุชุดูู ูุฑูุถ ุทูุจ
**ูู Filament Dashboard:**
1. ุงุฐูุจ ุฅูู "ุทูุจุงุช ุงููุณุชุดููุงุช"
2. ุงุถุบุท ุนูู "ุฑูุถ" ุจุฌุงูุจ ุฃู ุทูุจ
3. ุฃุถู ููุงุญุธุงุช (ุฅูุฒุงูู): "ูุง ูููู ูุจูู ุงูุทูุจ ูู ุงูููุช ุงูุญุงูู"
4. ุงุถุบุท "ููุงูู"

**Expected:**
- ูุชู ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ุฅูู "ูุฑููุถ"
- ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุณุชุฎุฏู

---

## ููุงุท ุงูุชุญูู ุงูููุงุฆูุฉ

### โ ุงูุชุญูู ูู ุงูุจูุงูุงุช:
1. [ ] ุชู ุฅูุดุงุก Super Admin ุจูุฌุงุญ
2. [ ] ุชู ุฅูุดุงุก ูุณุชุฎุฏููู Hospital ุจูุฌุงุญ
3. [ ] ุชู ุฅูุดุงุก ูุณุชุดููุงุช ูู Filament
4. [ ] ุชู ุฅูุดุงุก ูุฑูุถ ููุชุจุฑุน ุจูุฌุงุญ
5. [ ] ุชู ุชุญุฏูุซ ููุงูุน ุงููุณุชุฎุฏููู

### โ ุงูุชุญูู ูู SOS:
6. [ ] ุชู ุฅูุดุงุก ุทูุจ SOS ูู ุงููุฑูุถ
7. [ ] ุชู ุฅุฑุณุงู ุฅุดุนุงุฑ ูููุชุจุฑุน
8. [ ] ุงููุชุจุฑุน ูุฑู ุงูุญุงูุงุช ุงููุชุงุญุฉ

### โ ุงูุชุญูู ูู ุทูุจุงุช ุงููุณุชุดูู:
9. [ ] ุงููุฑูุถ ุฃุฑุณู ุทูุจ ูููุณุชุดูู
10. [ ] ุงููุชุจุฑุน ุฃุฑุณู ุทูุจ ูููุณุชุดูู
11. [ ] ุงููุณุชุดูู ูุฑู ุงูุทูุจุงุช ูู Dashboard
12. [ ] ุงููุณุชุดูู ูุงูู ุนูู ุงูุทูุจุงุช
13. [ ] ุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ูููุณุชุฎุฏููู

### โ ุงูุชุญูู ูู ุงูุญุงูุงุช:
14. [ ] ุงููุฑูุถ ูุฑู ุญุงูุงุชู ุงููุญุฏุซุฉ
15. [ ] ุงููุชุจุฑุน ูุฑู ุญุงูุงุชู ุงููุญุฏุซุฉ
16. [ ] ุงูุญุงูุงุช ุงูุฌุฏูุฏุฉ ุชุธูุฑ ุจุดูู ุตุญูุญ

---

## ููุงุญุธุงุช ูููุฉ

1. **ุงูุฅุญุฏุงุซูุงุช:** ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู ุฅุญุฏุงุซูุงุช ุตุญูุญุฉ (Latitude ุจูู -90 ู 90ุ Longitude ุจูู -180 ู 180)
2. **FCM Tokens:** ููุชุฌุฑุจุฉ ุงููุงููุฉุ ูุฌุจ ุฅุถุงูุฉ FCM tokens ูููุณุชุฎุฏููู ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
3. **ุงูุฃุฏูุงุฑ:** ูููู ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ูู Filament Shield ูู `/admin/shield/roles`
4. **ุงูุฅุนุฏุงุฏุงุช:** ูููู ุชุนุฏูู `sos_radius_km` ูู Filament ูู "ุงูุฅุนุฏุงุฏุงุช"

---

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุทูุจุงุช ูููุณุชุดูู
**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู ุงููุณุชุฎุฏู ูู ููุน `hospital`
- ุชุฃูุฏ ูู ูุฌูุฏ ูุณุชุดูู ูุฑุชุจุท ุจู `user_id` ูููุณุชุฎุฏู
- ุชุญูู ูู `getEloquentQuery()` ูู `HospitalRequestResource`

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุญุงูุงุช ูููุชุจุฑุน
**ุงูุญู:**
- ุชุฃูุฏ ูู ุชุญุฏูุซ ูููุน ุงููุชุจุฑุน
- ุชุฃูุฏ ูู ุฃู ูุตููุฉ ุงูุฏู ูุชูุงููุฉ
- ุชุญูู ูู `sos_radius_km` ูู ุงูุฅุนุฏุงุฏุงุช

### ุงููุดููุฉ: ูุง ูุชู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช
**ุงูุญู:**
- ุชุฃูุฏ ูู ุฅุถุงูุฉ `FCM_SERVER_KEY` ูู `.env`
- ุชุฃูุฏ ูู ูุฌูุฏ `fcm_token` ูููุณุชุฎุฏููู
- ุชุญูู ูู logs ูู `storage/logs/laravel.log`

---

## ููุงูุฉ ุงูุณููุงุฑูู

ุจุนุฏ ุฅููุงู ุฌููุน ุงูุฎุทูุงุชุ ูุฌุจ ุฃู ูููู ูุฏูู:
- โ ูุธุงู ูุงูู ูุนูู ูู ุงูุจุฏุงูุฉ ููููุงูุฉ
- โ ุทูุจุงุช SOS ุชุนูู ุจุดูู ุตุญูุญ
- โ ุทูุจุงุช ุงููุณุชุดููุงุช ุชุนูู ุจุดูู ุตุญูุญ
- โ ุงูููุงููุฉ/ุงูุฑูุถ ูู Dashboard ุชุนูู
- โ ุงูุฅุดุนุงุฑุงุช ุชูุฑุณู ูููุณุชุฎุฏููู
- โ ุงููุณุชุฎุฏููู ูุฑูู ุญุงูุงุชูู ุงููุญุฏุซุฉ

**ูุจุฑูู! ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ๐**


